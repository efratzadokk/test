<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Wizard</title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#fff">
    <meta name="format-detection" content="telephone=no">
    <meta name="description" content="Page description">
    <!-- Twitter Card data-->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@publisher_handle">
    <meta name="twitter:title" content="Page Title">
    <meta name="twitter:description" content="Page description less than 200 characters">
    <meta name="twitter:creator" content="@author_handle">
    <meta name="twitter:image" content="http://www.example.com/image.jpg">
    <!-- Open Graph data-->
    <meta property="og:title" content="Title Here">
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://www.example.com/">
    <meta property="og:image" content="http://example.com/image.jpg">
    <meta property="og:description" content="Description Here">
    <meta property="og:site_name" content="Site Name, i.e. Moz">
    <meta property="fb:admins" content="Facebook numeric ID">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/css/app.css">
    <!-- favicon-->
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/img/leader_favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/img/leader_favicon.png">
    <link rel="manifest" href="../assets/img/site.webmanifest">
    <link rel="mask-icon" href="../assets/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <!-- jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-analytics.js"></script>

    <!-- js -->
    <script>

    const getCookie = (c_name) => {
        if (document.cookie.length > 0) {
            c_start = document.cookie.indexOf(c_name + "=");
            if (c_start != -1) {
                c_start = c_start + c_name.length + 1;
                c_end = document.cookie.indexOf(";", c_start);
                if (c_end == -1) {
                    c_end = document.cookie.length;
                }
                return unescape(document.cookie.substring(c_start, c_end));
            }
        }
        return "";
    }

    const usernameCheck = () => {
        const jwt = getCookie('jwt')
        const value = document.querySelector('input#usernameInput').value
        const data = {token: jwt, usernameToCheck: value}
        fetch("https://api.leader.codes/register/usernameCheck", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': jwt
            },
            body: JSON.stringify(data),
        })
        .then($ => $.json())
        .then($ => {
            if (!$.availability) {
                document.querySelector('#errMsg').innerText = 'The username is already taken. Please choose another username.'
            } else {
                alert('Username available and created!')
                window.location.href = "https://hub.leader.codes/" + $.uid
            }
        })
    }

    </script>

<body>
    <!-- auth-->
    <div class="auth">
        <div class="auth__main" style="background-image: url(assets/img/bg-login-mobile.jpg)">
            <div class="auth__wrap">
                <div class="auth__preview"><img class="auth__pic" src="assets/img/logo-white.svg" width="48" alt="Logo">
                </div>
                <div class="auth__title title title_xl">Welcome to Leader</div>
                <div class="auth__subtitle title title_sm">Enter your details to proceed further</div>
            </div>
        </div>
        <div class="auth__container">
            <div class="auth__inner">
                <div class="auth__head">
                    <div class="auth__title title title_xl">
                        <p>Welcome to Leader.</p>
                    </div>
                    <p>Please select a username to complete the registration process</p>
                </div>
                <form class="auth__form" id="loginFrom" method="post">
                    <div class="field auth__field">
                        <div class="field__label">Username</div>
                        <div class="field__wrap"><input id="usernameInput" name="username" class="field__input" type="text"
                                placeholder="Start typingâ€¦">
                            <div class="field__icon"><i class="la la-user "></i></div>
                        </div>
                    </div>
                    <input type="hidden" name="submitedFlag">
                    <div class="auth__btns">
                        <a id="signupBtn" class="btn btn_light auth__btn" style="user-select: none; cursor: pointer;"  onclick="usernameCheck()">Continue</a></div>
                    <!-- enter-->
                    <div id="errMsg" style="color:red"></div>

                </form>
            </div>
        </div>
        <div class="auth__bg" style="background-image: url(assets/img/bg-login-sign-in.jpg)"></div>
        <div id="wait" style="display:none;z-index:2;position:absolute;top:50%;left:50%;">
            <img src='https://cdn.dribbble.com/users/225707/screenshots/2958729/attachments/648705/straight-loader.gif'
                width="64" height="64" /><br>Loading..
        </div>
    </div>
    <!-- scripts-->
    <script src="assets/js/core/jquery.min.js"></script>
    <script src="assets/js/core/datepicker.min.js"></script>
    <script src="assets/js/core/datepicker.en.js"></script>
    <script src="assets/js/core/select2.min.js"></script>
    <script src="assets/js/core/wNumb.min.js"></script>
    <script src="assets/js/core/nouislider.min.js"></script>
    <script src="assets/js/core/apexcharts.min.js"></script>
    <script src="assets/js/charts.js"></script>
    <script src="assets/js/app.js"></script>


</body>

</html>
